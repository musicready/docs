---
title: "The Problem & Why MRS is Feasible"
description: "A clear statement of the problem MRS solves and why this approach will work for AI-driven composition at professional scale."
---

## The Vision

**MRS enables AI-driven composition of full orchestral works—symphonies, vocal arrangements, film scores—through iterative conversation with humans in the loop.**

Think of it as "the opencode of Dorico": professional-grade notation infrastructure designed from the ground up for agent-driven workflows, where you can go from a chord chart or initial sketch to a fully orchestrated symphony through AI collaboration.

This is not a simplified demo. This is the hardest version of the problem: creating complex, multi-movement works from scratch, iteratively, with the granularity required for professional Dorico-level projects.

---

## The Core Problem

AI cannot currently compose or edit full orchestral scores reliably. Three fundamental challenges block progress:

### 1. The Scale Problem

A full orchestral score is too large for any AI context window:

| Score Type | Parts | Measures | Events | Tokens |
|------------|-------|----------|--------|--------|
| Lead sheet | 1 | 32 | ~200 | ~2K |
| Piano sonata | 2 | 300 | ~5,000 | ~40K |
| String quartet | 4 | 400 | ~8,000 | ~65K |
| Full orchestra | 90 | 1000 | ~200,000 | ~1.5M |

No LLM can hold a full orchestral score. More importantly, it shouldn't have to. Editing measure 847 should not require loading measures 1–846.

### 2. The Context Problem

Musical decisions require understanding surrounding material. Writing a clarinet countermelody requires knowing:
- What melodic material it responds to
- The harmonic context (what chords are sounding)
- Where phrase boundaries fall
- What comes before and after

Simple "slice some measures as text" approaches fail because music is structurally entangled: meter, phrasing, harmony, and spans (slurs, hairpins, pedal) all interact across measure boundaries.

### 3. The Reliability Problem

Existing approaches ask AI to emit complete, structurally-valid score fragments. This creates high failure rates:

- **Accidental omissions**: Agent returns less content than given → content silently deleted
- **Calculation errors**: Miscomputed absolute positions, duration sums that don't add up
- **Hallucinated references**: Agent references IDs that don't exist in the score
- **Format violations**: Malformed syntax, missing required fields

Even with good models, these failures require multiple repair loops, destroying productivity.

---

## Why Existing Solutions Fail

### MusicXML / MEI
- **Too verbose**: A simple melody requires hundreds of lines of XML
- **No context management**: No built-in mechanism for bounded editing with context
- **Positional references**: Break on structural changes
- **Not agent-friendly**: Designed for interchange between notation apps, not AI workflows

### ABC Notation / LilyPond
- **No formal grammar**: Ambiguous parsing, especially for complex scores
- **No stable identity**: No UUIDs, no way to reference "this specific note" across edits
- **Human-entry optimized**: Shortcuts and abbreviations that confuse machine generation

### MIDI
- **No semantic content**: Pure performance data, no notation semantics
- **No structure**: No measures, no phrase boundaries, no form

---

## The MRS Solution

MRS solves these problems through architectural separation:

### 1. Separate Storage from Mutation

**MRS-S** (storage): Complete, archival-quality encoding with stable UUIDs. Agents READ this.

**MRS-Ops** (mutation): Typed operation protocol with orchestrator-derived fields. Agents WRITE this.

```
Agent reads:  Working Set Envelope (MRS-S fragment + context views)
Agent writes: MRS-Ops (typed operations with tmp-ids)
Orchestrator: Validates → Maps tmp-ids to UUIDs → Computes derived fields → Applies
```

This eliminates:
- Accidental deletions (explicit create/update/delete operations)
- Calculation errors (orchestrator computes `:at`, `:beat-start`)
- Hallucinated references (orchestrator validates all refs before application)

### 2. Orchestrator Authority

The orchestrator is the sole authority for:
- UUID minting (agents use temporary IDs)
- Derived field computation
- Canonical state management
- Validation and application

Agents cannot create invalid references or miscalculate derived fields—the orchestrator handles it.

### 3. Task-Adaptive Context Views

Instead of fixed "near/far" reduction rings, agents receive context views tailored to their specific task:

| Task Type | Context Views |
|-----------|---------------|
| Countermelody | Melodic reference, harmonic context, phrase structure |
| Orchestration | Orchestration map, texture density, dynamics profile |
| Dynamics pass | Phrase structure, existing dynamics, climax points |

This provides what's actually needed, not just "nearby measures at reduced detail."

### 4. Professional Orchestration Semantics

The **Player → Instrument → Staff** model supports real-world orchestration:

```clojure
(player woodwind-2
  :name "Flute 2 / Piccolo"
  :instruments [flute-2 piccolo]
  :default flute-2)
```

- Instrument doubling (Flute 2 / Piccolo)
- Mid-score instrument changes
- Transposition handling across changes
- Percussion kits

### 5. Progressive Validation

Operations are validated in stages:
1. **Syntax**: Operation is well-formed
2. **References**: All IDs exist (or are valid tmp-ids)
3. **Permissions**: Operation within granted lanes/scope
4. **Musical rules**: Constraints satisfied (range, parallel fifths, etc.)

Errors caught before state mutation. Specific feedback. No silent corruption.

---

## Why This Approach is Feasible

### The Scale Problem → Solved by Scoped Extraction

Working Set Envelopes reduce a 1.5M token orchestral score to a focused fragment (typically 5-50K tokens) with task-appropriate context.

### The Context Problem → Solved by Task-Adaptive Views

Context views provide what's actually needed for the task—melodic references, harmonic context, texture maps—not fixed "more measures at reduced detail."

### The Reliability Problem → Solved by Architecture

| Failure Mode | How MRS Eliminates It |
|--------------|----------------------|
| Accidental deletion | Explicit operations (create/update/delete) |
| Calculation errors | Orchestrator computes derived fields |
| Hallucinated references | Orchestrator validates all refs |
| Format violations | Typed operations with schema |

### The Iteration Problem → Solved by the Orchestrator Pattern

```
         ORCHESTRATOR (owns canonical state)
         │         │         │         │
         ▼         ▼         ▼         ▼
     Harmony    Melody    Orch.    Expression
     Agent      Agent     Agent      Agent
```

Agents write operations; orchestrator validates and applies. Conflicts detected via source-hash. Lane bundles grant appropriate permissions.

---

## The Hardest Version of the Problem

MRS is designed for the most demanding case: **creating a symphony from scratch, iteratively, through AI conversation**.

This means supporting:

1. **Structural creation**: Insert measures, sections, movements—not just edit existing content
2. **Incomplete states**: Early-stage work has placeholders ("strings texture TBD", "orchestrate later")
3. **Professional orchestration**: Player/instrument model with doubling, switching, condensing
4. **Cross-boundary spans**: Hairpins, slurs, pedal marks that cross edit boundaries
5. **Human-in-the-loop checkpoints**: Lock form, lock harmony, lock orchestration at appropriate stages
6. **Low repair loops**: Typed operations + progressive validation keep iteration fast

If MRS handles symphonies-from-scratch, it handles everything simpler too.

---

## What Makes This Achievable

### 1. The Orchestrator is the Product

The core IP is not the syntax—it's the **orchestrator + validation + typed operations**. MRS-S is the canonical representation; the orchestrator is what makes iterative composition safe and reliable.

### 2. AI Quality Will Improve

MRS doesn't require AI to be perfect. It provides:
- **Safety rails**: Progressive validation catches errors before they propagate
- **Bounded scope**: Mistakes are contained to the working set
- **Human review gates**: Checkpoints for approval before proceeding

As AI improves, the system captures that improvement. As AI makes errors, the system contains them.

### 3. Human-in-the-Loop is a Feature

Professional composition is inherently collaborative. MRS supports:
- Human approval at structural checkpoints
- Semantic diffs for reviewing AI changes (operations, not text noise)
- Playback preview integration
- The ability to lock decisions ("form is final") and iterate on details

---

## Feasibility Summary

| Challenge | Solution | Status |
|-----------|----------|--------|
| Scale (scores too large) | Working Set Envelopes with scoped extraction | **Solved** |
| Context (decisions need surroundings) | Task-adaptive context views | **Solved** |
| Reliability (agents make errors) | MRS-Ops + orchestrator authority + progressive validation | **Solved** |
| Structural fragility (references break) | UUID-first identity | **Solved** |
| Professional orchestration | Player-Instrument-Staff model | **Solved** |
| Safe iteration (edits conflict) | Single-writer orchestrator + lane bundles | **Solved** |
| From-scratch composition | Draft states + checkpoints | **Solved** |

The approach is **feasible**. The core architectural decisions are sound. What remains is disciplined implementation of the orchestrator semantics—validation pipeline, operation application, context generation—which are well-understood problems with clear solutions.

---

## Next Steps

The following specifications complete the architecture for professional-scale AI composition:

- [Orchestrator Contract](/orchestrator-contract) — Validation, transactions, conflict detection
- [Working Set Envelope](/working-set-envelope) — Scoped extraction with context
- [MRS-Ops Protocol](/agentic-operations) — Typed operations for agent mutations

See also:
- [Design Principles](/design-principles) — Core philosophy
- [Architecture Overview](/architecture-overview) — Component relationships
